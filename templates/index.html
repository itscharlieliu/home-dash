<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ app_name }}</title>
    <link rel="icon" href="{{ url_for('favicon') }}" type="image/svg+xml" />
    <link rel="stylesheet" href="{{ url_for('static', path='styles.css') }}" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js"
      integrity="sha384-Sse/HDqcypGpyTDpvZOJNnG0TT3feGQUkF9H+mnRvic+LjR+K1NhTt8f51KIQ3v3" crossorigin="anonymous"
      defer></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"
      integrity="sha384-cVMg8E3QFwTvGCDuK+ET4PD341jF3W8nO1auiXfuZNQkzbUUiBGLsIQUE+b1mxws" crossorigin="anonymous"
      defer></script>
  </head>
  <body>
    <header class="app-header">
      <h1>{{ app_name }}</h1>
      <div class="header-meta">
        <span class="badge">Refresh: {{ refresh_interval }}s</span>
        <a href="{{ url_for('read_metrics') }}" class="badge badge-link">API</a>
        <a
          href="https://github.com/charlie/home-dash"
          target="_blank"
          rel="noopener"
          class="badge badge-link"
        >
          Source
        </a>
      </div>
    </header>
    <main>
      <section class="metrics-grid">
        {% for metric in metrics %}
        {% set column_span = metric.display.get('column_span') if metric.display else None %}
        <article class="metric-card" {% if column_span %}style="grid-column: span {{ column_span }};" {% endif %}
          data-metric-id="{{ metric.id }}" data-display-type="{{ metric.display.type }}"
          data-display-config='{{ metric.display | tojson }}'>
          <header>
            <h2>{{ metric.name }}</h2>
            <p>{{ metric.description }}</p>
          </header>
          <div class="metric-body">
            <div class="metric-chart-container">
              <canvas class="metric-chart hidden" aria-hidden="true"></canvas>
            </div>
            <pre class="metric-output">Loading...</pre>
          </div>
        </article>
        {% endfor %}
      </section>
    </main>
    <script id="home-dash-config" type="application/json">
              {{ {
                "refreshInterval": refresh_interval,
                "historyLimit": history_limit,
                "metrics": metrics
              } | tojson }}
    </script>
    <script src="{{ url_for('static', path='app.js') }}"></script>
  </body>
</html>

